# WEBOOK - äºŒæ‰‹ä¹¦äº¤æ˜“å¹³å°

ä¸€ä¸ªåŸºäº Flask çš„äºŒæ‰‹ä¹¦äº¤æ˜“å¹³å°ï¼Œé›†æˆäº†**æ™ºèƒ½è¯­ä¹‰æ£€ç´¢**åŠŸèƒ½ï¼Œæ”¯æŒç”¨æˆ·é€šè¿‡å…³é”®è¯æˆ–è‡ªç„¶è¯­è¨€æè¿°æŸ¥æ‰¾ä¹¦ç±ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸ“š **å•†å“ç®¡ç†**: ä¸Šä¼ ã€æµè§ˆã€æœç´¢äºŒæ‰‹ä¹¦ç±
- ğŸ” **ç”¨æˆ·ç³»ç»Ÿ**: æ³¨å†Œã€ç™»å½•ã€ä¼šè¯ç®¡ç†
- ğŸ” **åŒæ¨¡å¼æœç´¢**:
  - å…³é”®è¯æœç´¢: ç²¾ç¡®åŒ¹é…ä¹¦åå’Œæè¿°
  - **è¯­ä¹‰æœç´¢**: åŸºäº AI ç†è§£æŸ¥è¯¢å«ä¹‰ï¼Œæ™ºèƒ½åŒ¹é…ç›¸å…³ä¹¦ç±
- ğŸ–¼ï¸ **å›¾ç‰‡ä¸Šä¼ **: æ”¯æŒä¹¦ç±å°é¢ä¸Šä¼ å’Œå±•ç¤º
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**: MySQL æ•°æ®åº“å­˜å‚¨

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Flask**: Web æ¡†æ¶
- **SQLAlchemy**: ORM æ•°æ®åº“æ˜ å°„
- **Flask-Bcrypt**: å¯†ç åŠ å¯†
- **PyMySQL**: MySQL æ•°æ®åº“é©±åŠ¨

### è¯­ä¹‰æ£€ç´¢
- **Sentence-Transformers**: æ–‡æœ¬å‘é‡åŒ–æ¨¡å‹
- **Faiss**: é«˜æ•ˆå‘é‡ç›¸ä¼¼åº¦æœç´¢
- **PyTorch**: æ·±åº¦å­¦ä¹ æ¡†æ¶

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Python 3.8+
- MySQL 5.7+ / 8.0+
- è‡³å°‘ 2GB å¯ç”¨å†…å­˜ï¼ˆç”¨äºåŠ è½½è¯­ä¹‰æ¨¡å‹ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
cd c:\Users\12641\Desktop\WeBook
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

```powershell
python -m venv venv
.\venv\Scripts\Activate.ps1
```

### 3. å®‰è£…ä¾èµ–

```powershell
pip install -r requirements.txt
```

**æ³¨æ„**: é¦–æ¬¡å®‰è£…ä¼šä¸‹è½½è¯­ä¹‰æ¨¡å‹ï¼ˆçº¦ 100MBï¼‰ï¼Œè¯·ä¿æŒç½‘ç»œç•…é€šã€‚

### 4. é…ç½®æ•°æ®åº“

#### æ–¹å¼ä¸€: ä½¿ç”¨ MySQL å‘½ä»¤è¡Œ

```sql
mysql -u root -p
CREATE DATABASE webook_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;
```

#### æ–¹å¼äºŒ: ä½¿ç”¨ MySQL Workbench æˆ–å…¶ä»–å›¾å½¢åŒ–å·¥å…·

åˆ›å»ºæ•°æ®åº“ `webook_db`ï¼Œå­—ç¬¦é›†é€‰æ‹© `utf8mb4`ã€‚

### 5. é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```env
DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=root
DB_PASSWORD=ä½ çš„å¯†ç 
DB_NAME=webook_db
```

### 6. åˆå§‹åŒ–æ•°æ®åº“å’Œç´¢å¼•

```powershell
python init_db.py
```

åœ¨èœå•ä¸­é€‰æ‹© `4` (å…¨éƒ¨æ‰§è¡Œ) ä»¥ï¼š
- åˆ›å»ºæ•°æ®åº“è¡¨
- æ·»åŠ ç¤ºä¾‹æ•°æ®
- æ„å»ºè¯­ä¹‰æ£€ç´¢ç´¢å¼•

### 7. å¯åŠ¨åº”ç”¨

```powershell
python app.py
```

è®¿é—®: http://localhost:5003

## ğŸ“– ä½¿ç”¨æŒ‡å—

### è¯­ä¹‰æœç´¢ç¤ºä¾‹

#### å…³é”®è¯æœç´¢
è¾“å…¥: `Python`
ç»“æœ: ç²¾ç¡®åŒ¹é…åŒ…å« "Python" çš„ä¹¦åæˆ–æè¿°

#### è¯­ä¹‰æœç´¢
è¾“å…¥: `æˆ‘æƒ³å­¦ä¹ äººå·¥æ™ºèƒ½`
ç»“æœ: æ™ºèƒ½åŒ¹é…ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨ã€‹ã€ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç­‰ç›¸å…³ä¹¦ç±

è¾“å…¥: `ç¼–ç¨‹åŸºç¡€æ•™ç¨‹`
ç»“æœ: åŒ¹é…ã€ŠPythonç¼–ç¨‹ä»å…¥é—¨åˆ°å®è·µã€‹ç­‰å…¥é—¨ç±»ä¹¦ç±

### API æ¥å£

#### è¯­ä¹‰æœç´¢ API
```http
POST /api/semantic_search
Content-Type: application/json

{
  "query": "æ•°æ®ç»“æ„ç®—æ³•",
  "top_k": 10
}
```

#### é‡å»ºç´¢å¼• API
```http
POST /api/rebuild_index
```

## ğŸ”§ é¡¹ç›®ç»“æ„

```
WeBook/
â”œâ”€â”€ app.py                  # Flask ä¸»åº”ç”¨
â”œâ”€â”€ config.py              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ semantic_search.py     # è¯­ä¹‰æ£€ç´¢æœåŠ¡
â”œâ”€â”€ init_db.py            # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ requirements.txt      # ä¾èµ–æ¸…å•
â”œâ”€â”€ .env                  # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ templates/            # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ login.html
â”‚   â”œâ”€â”€ register.html
â”‚   â”œâ”€â”€ homepage.html
â”‚   â”œâ”€â”€ search.html      # æœç´¢é¡µé¢ï¼ˆå«è¯­ä¹‰æ£€ç´¢ï¼‰
â”‚   â””â”€â”€ ...
â”œâ”€â”€ uploads/             # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
â”‚   â””â”€â”€ images/         # å›¾ç‰‡èµ„æº
â””â”€â”€ data/               # æ•°æ®æ–‡ä»¶
    â”œâ”€â”€ faiss_index.bin      # Faiss å‘é‡ç´¢å¼•
    â””â”€â”€ faiss_index_metadata.pkl  # ç´¢å¼•å…ƒæ•°æ®
```

## âš™ï¸ é…ç½®è¯´æ˜

### è¯­ä¹‰æ¨¡å‹é…ç½®

åœ¨ `.env` ä¸­å¯ä»¥æ›´æ¢ä¸åŒçš„è¯­ä¹‰æ¨¡å‹ï¼š

```env
# å¤šè¯­è¨€æ¨¡å‹ï¼ˆé»˜è®¤ï¼Œæ”¯æŒä¸­æ–‡ï¼‰
SEMANTIC_MODEL=paraphrase-multilingual-MiniLM-L12-v2

# ä¸­æ–‡ä¸“ç”¨æ¨¡å‹ï¼ˆæ›´å¥½çš„ä¸­æ–‡æ•ˆæœï¼Œä½†ä½“ç§¯æ›´å¤§ï¼‰
# SEMANTIC_MODEL=shibing624/text2vec-base-chinese

# è‹±æ–‡æ¨¡å‹ï¼ˆä»…è‹±æ–‡åœºæ™¯ï¼‰
# SEMANTIC_MODEL=all-MiniLM-L6-v2
```

### å‘é‡ç»´åº¦

ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„å‘é‡ç»´åº¦ï¼Œéœ€åœ¨ `.env` ä¸­åŒ¹é…ï¼š

- `paraphrase-multilingual-MiniLM-L12-v2`: 384
- `all-MiniLM-L6-v2`: 384
- `text2vec-base-chinese`: 768

## ğŸ› å¸¸è§é—®é¢˜

### 1. å¯¼å…¥é”™è¯¯: æ— æ³•è§£æå¯¼å…¥ "xxx"

**åŸå› **: ä¾èµ–æœªå®‰è£…æˆ–è™šæ‹Ÿç¯å¢ƒæœªæ¿€æ´»

**è§£å†³**:
```powershell
.\venv\Scripts\Activate.ps1
pip install -r requirements.txt
```

### 2. æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥æ¸…å•**:
- MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ•°æ®åº“åç§°æ˜¯å¦æ­£ç¡®åˆ›å»º
- `.env` ä¸­çš„ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
- é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è¿æ¥

### 3. è¯­ä¹‰æœç´¢æ— ç»“æœ

**å¯èƒ½åŸå› **:
- ç´¢å¼•æœªåˆ›å»ºï¼Œè¿è¡Œ `python init_db.py` é€‰æ‹©é€‰é¡¹ 3
- æ•°æ®åº“æ— å•†å“æ•°æ®
- æ¨¡å‹åŠ è½½å¤±è´¥ï¼Œæ£€æŸ¥ç½‘ç»œå’Œç£ç›˜ç©ºé—´

### 4. é¦–æ¬¡è¿è¡Œå¾ˆæ…¢

**åŸå› **: é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½è¯­ä¹‰æ¨¡å‹ï¼ˆçº¦ 100MBï¼‰

**è§£å†³**: è€å¿ƒç­‰å¾…ä¸‹è½½å®Œæˆï¼Œæ¨¡å‹ä¼šç¼“å­˜åˆ°æœ¬åœ°

## ğŸ”„ æ•°æ®ç®¡ç†

### é‡å»ºç´¢å¼•

å½“å•†å“æ•°æ®å˜æ›´è¾ƒå¤šæ—¶ï¼Œå»ºè®®é‡å»ºç´¢å¼•ï¼š

```powershell
python init_db.py
# é€‰æ‹©é€‰é¡¹ 3
```

æˆ–é€šè¿‡ API:
```bash
curl -X POST http://localhost:5003/api/rebuild_index
```

### å¤‡ä»½æ•°æ®

```bash
mysqldump -u root -p webook_db > backup.sql
```

### æ¢å¤æ•°æ®

```bash
mysql -u root -p webook_db < backup.sql
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- **ç´¢å¼•ç¼“å­˜**: Faiss ç´¢å¼•ä¼šè‡ªåŠ¨ä¿å­˜åˆ°ç£ç›˜ï¼Œé‡å¯åå¿«é€ŸåŠ è½½
- **æ‰¹é‡æ·»åŠ **: æ–°å¢å¤§é‡å•†å“åï¼Œä½¿ç”¨é‡å»ºç´¢å¼•è€Œéé€ä¸ªæ·»åŠ 
- **æ¨¡å‹é€‰æ‹©**: å°æ¨¡å‹é€Ÿåº¦å¿«ä½†ç²¾åº¦ç•¥ä½ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**å¼€å‘è€…**: WeBook Team  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ16æ—¥